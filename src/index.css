@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /*
     * LIGHT MODE - Warm Cream/Sand Palette
     * Inspired by elegant paper, warm natural tones, and exceptional legibility
     * Think: refined stationery, warm afternoon light, natural textures
     */

    /* Warm cream background - not stark white, inviting and easy on eyes */
    --background: 40 33% 96%;
    --foreground: 25 25% 15%;

    /* Cards: slightly warmer than background for subtle depth */
    --card: 40 40% 98%;
    --card-foreground: 25 25% 15%;

    /* Popovers with slight warmth */
    --popover: 40 40% 99%;
    --popover-foreground: 25 25% 15%;

    /* Primary - Deeper forest green for better contrast on light */
    --primary: 145 45% 38%;
    --primary-foreground: 40 40% 98%;

    /* Secondary - Warm stone gray */
    --secondary: 35 15% 90%;
    --secondary-foreground: 25 20% 25%;

    /* Muted - Soft warm gray for subtle text */
    --muted: 35 15% 92%;
    --muted-foreground: 25 10% 45%;

    /* Accent - Sand/amber tint */
    --accent: 38 25% 88%;
    --accent-foreground: 25 20% 20%;

    /* Destructive */
    --destructive: 0 72% 51%;
    --destructive-foreground: 40 40% 98%;

    /* Borders - subtle warm gray */
    --border: 35 20% 85%;
    --input: 35 20% 88%;
    --ring: 145 45% 38%;
    --radius: 1rem;

    /* Accent colors - optimized for light backgrounds */
    --mint: 145 50% 35%;
    --lavender: 262 40% 55%;
    --amber: 40 90% 45%;
    --rose: 340 70% 50%;
    --cyan: 190 75% 40%;
  }

  .dark {
    /*
     * DARK MODE - Deep black with mint accents
     * Sophisticated, high contrast, easy on eyes in low light
     */

    /* Deep black background */
    --background: 0 0% 7%;
    --foreground: 0 0% 95%;

    /* Card with subtle elevation */
    --card: 0 0% 11%;
    --card-foreground: 0 0% 95%;

    /* Popover */
    --popover: 0 0% 11%;
    --popover-foreground: 0 0% 95%;

    /* Primary - Mint green accent */
    --primary: 142 52% 54%;
    --primary-foreground: 0 0% 7%;

    /* Secondary - Subtle dark */
    --secondary: 0 0% 15%;
    --secondary-foreground: 0 0% 95%;

    /* Muted text and backgrounds */
    --muted: 0 0% 15%;
    --muted-foreground: 0 0% 55%;

    /* Accent */
    --accent: 0 0% 18%;
    --accent-foreground: 0 0% 95%;

    /* Destructive */
    --destructive: 0 62.8% 50%;
    --destructive-foreground: 0 0% 95%;

    /* Borders and inputs */
    --border: 0 0% 18%;
    --input: 0 0% 15%;
    --ring: 142 52% 54%;

    /* Accent colors for cards */
    --mint: 142 52% 54%;
    --lavender: 262 47% 72%;
    --amber: 45 93% 58%;
    --rose: 340 75% 72%;
    --cyan: 187 85% 53%;
  }

  /* Light mode class for explicit light mode */
  .light {
    /* Same as :root light mode values */
    --background: 40 33% 96%;
    --foreground: 25 25% 15%;
    --card: 40 40% 98%;
    --card-foreground: 25 25% 15%;
    --popover: 40 40% 99%;
    --popover-foreground: 25 25% 15%;
    --primary: 145 45% 38%;
    --primary-foreground: 40 40% 98%;
    --secondary: 35 15% 90%;
    --secondary-foreground: 25 20% 25%;
    --muted: 35 15% 92%;
    --muted-foreground: 25 10% 45%;
    --accent: 38 25% 88%;
    --accent-foreground: 25 20% 20%;
    --destructive: 0 72% 51%;
    --destructive-foreground: 40 40% 98%;
    --border: 35 20% 85%;
    --input: 35 20% 88%;
    --ring: 145 45% 38%;
    --mint: 145 50% 35%;
    --lavender: 262 40% 55%;
    --amber: 40 90% 45%;
    --rose: 340 70% 50%;
    --cyan: 190 75% 40%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    @apply bg-background text-foreground;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
}

@layer components {
  /* Glass card effect - theme-aware */
  .glass-card {
    @apply bg-card/80 backdrop-blur-xl border border-border/50;
  }

  /* Elevated card with glow - theme-aware shadows */
  .card-elevated {
    @apply bg-card rounded-2xl border border-border/50;
  }

  .dark .card-elevated {
    box-shadow:
      0 0 0 1px rgba(255, 255, 255, 0.03),
      0 2px 4px rgba(0, 0, 0, 0.2),
      0 8px 16px rgba(0, 0, 0, 0.2);
  }

  .light .card-elevated {
    box-shadow:
      0 0 0 1px rgba(0, 0, 0, 0.03),
      0 2px 4px rgba(0, 0, 0, 0.05),
      0 8px 16px rgba(0, 0, 0, 0.08);
  }

  /* Accent cards */
  .card-mint {
    background: linear-gradient(135deg, hsl(var(--mint) / 0.15) 0%, hsl(var(--mint) / 0.05) 100%);
    border-color: hsl(var(--mint) / 0.2);
  }

  .card-lavender {
    background: linear-gradient(135deg, hsl(var(--lavender) / 0.15) 0%, hsl(var(--lavender) / 0.05) 100%);
    border-color: hsl(var(--lavender) / 0.2);
  }

  .card-amber {
    background: linear-gradient(135deg, hsl(var(--amber) / 0.15) 0%, hsl(var(--amber) / 0.05) 100%);
    border-color: hsl(var(--amber) / 0.2);
  }

  .card-rose {
    background: linear-gradient(135deg, hsl(var(--rose) / 0.15) 0%, hsl(var(--rose) / 0.05) 100%);
    border-color: hsl(var(--rose) / 0.2);
  }

  /* Solid accent backgrounds */
  .bg-mint {
    background-color: hsl(var(--mint));
  }

  .bg-lavender {
    background-color: hsl(var(--lavender));
  }

  .bg-amber {
    background-color: hsl(var(--amber));
  }

  .bg-rose {
    background-color: hsl(var(--rose));
  }

  .bg-cyan {
    background-color: hsl(var(--cyan));
  }

  /* Text colors */
  .text-mint {
    color: hsl(var(--mint));
  }

  .text-lavender {
    color: hsl(var(--lavender));
  }

  .text-amber {
    color: hsl(var(--amber));
  }

  .text-rose {
    color: hsl(var(--rose));
  }

  /* Pill/tag styles */
  .pill {
    @apply px-3 py-1 text-xs font-medium rounded-full border;
  }

  .pill-outline {
    @apply bg-transparent border-border text-foreground/80;
  }

  .pill-mint {
    @apply bg-[hsl(var(--mint)/0.15)] border-[hsl(var(--mint)/0.3)] text-[hsl(var(--mint))];
  }

  .pill-lavender {
    @apply bg-[hsl(var(--lavender)/0.15)] border-[hsl(var(--lavender)/0.3)] text-[hsl(var(--lavender))];
  }

  .pill-amber {
    @apply bg-[hsl(var(--amber)/0.15)] border-[hsl(var(--amber)/0.3)] text-[hsl(var(--amber))];
  }

  /* Icon containers */
  .icon-container {
    @apply flex items-center justify-center rounded-xl p-3;
  }

  .icon-mint {
    @apply bg-[hsl(var(--mint)/0.15)] text-[hsl(var(--mint))];
  }

  .icon-lavender {
    @apply bg-[hsl(var(--lavender)/0.15)] text-[hsl(var(--lavender))];
  }

  .icon-amber {
    @apply bg-[hsl(var(--amber)/0.15)] text-[hsl(var(--amber))];
  }

  .icon-rose {
    @apply bg-[hsl(var(--rose)/0.15)] text-[hsl(var(--rose))];
  }

  /* Button styles */
  .btn-primary {
    @apply px-6 py-3 font-semibold rounded-xl transition-all duration-200;
    @apply bg-primary text-primary-foreground;
    @apply hover:brightness-110 hover:scale-[1.02] active:scale-[0.98];
  }

  .btn-secondary {
    @apply px-6 py-3 font-semibold rounded-xl transition-all duration-200;
    @apply bg-secondary text-secondary-foreground border border-border/50;
    @apply hover:bg-secondary/80 hover:border-border;
  }

  .btn-ghost {
    @apply px-4 py-2 font-medium rounded-xl transition-all duration-200;
    @apply text-muted-foreground hover:text-foreground hover:bg-accent;
  }

  /* Input styles - theme-aware */
  .input-field {
    @apply w-full px-4 py-3 rounded-xl transition-all duration-200;
    @apply bg-secondary border border-border/50;
    @apply placeholder:text-muted-foreground;
    @apply focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50;
  }

  /* Legacy alias */
  .input-dark {
    @apply input-field;
  }

  /* Select styles - theme-aware */
  .select-field {
    @apply w-full px-4 py-3 rounded-xl transition-all duration-200;
    @apply bg-secondary border border-border/50;
    @apply text-foreground;
    @apply focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50;
    @apply cursor-pointer appearance-none;
    background-position: right 0.75rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
  }

  .dark .select-field {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  }

  .light .select-field {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%234b5563' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  }

  /* Legacy alias */
  .select-dark {
    @apply select-field;
  }
}

@layer utilities {
  /* Gradient text */
  .gradient-text {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(135deg, hsl(var(--mint)) 0%, hsl(var(--cyan)) 100%);
  }

  /* Subtle glow effects */
  .glow-mint {
    box-shadow: 0 0 20px hsl(var(--mint) / 0.3);
  }

  .glow-lavender {
    box-shadow: 0 0 20px hsl(var(--lavender) / 0.3);
  }

  .glow-amber {
    box-shadow: 0 0 20px hsl(var(--amber) / 0.3);
  }

  /* Animated gradient border */
  .border-gradient {
    position: relative;
    background: hsl(var(--card));
    border-radius: 1rem;
  }

  .border-gradient::before {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(135deg, hsl(var(--mint) / 0.5), hsl(var(--lavender) / 0.5), hsl(var(--amber) / 0.5));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  /* Staggered animation delays */
  .stagger-1 { animation-delay: 0.1s; }
  .stagger-2 { animation-delay: 0.2s; }
  .stagger-3 { animation-delay: 0.3s; }
  .stagger-4 { animation-delay: 0.4s; }
  .stagger-5 { animation-delay: 0.5s; }
}

/* Custom animations */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px hsl(var(--mint) / 0.3); }
  50% { box-shadow: 0 0 40px hsl(var(--mint) / 0.5); }
}

@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-float {
  animation: float 3s ease-in-out infinite;
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

.animate-slide-up {
  /* 'both' applies starting state immediately (prevents flash) and keeps end state */
  animation: slide-up 0.5s ease-out both;
}

.animate-fade-in {
  /* 'both' applies starting state immediately (prevents flash) and keeps end state */
  animation: fade-in 0.3s ease-out both;
}

/* Mobile FAB animations */
@keyframes fab-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

@keyframes fab-pulse {
  0%, 100% { box-shadow: 0 10px 25px -5px hsl(var(--primary) / 0.25), 0 0 0 0 hsl(var(--primary) / 0.4); }
  50% { box-shadow: 0 10px 25px -5px hsl(var(--primary) / 0.25), 0 0 0 12px hsl(var(--primary) / 0); }
}

.animate-fab-float {
  animation: fab-float 3s ease-in-out infinite;
}

.animate-fab-pulse {
  animation: fab-pulse 2s ease-out 3;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--background));
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--muted));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground));
}

/* Selection styling */
::selection {
  background: hsl(var(--mint) / 0.3);
  color: hsl(var(--foreground));
}

/* ============================================================================
   ROLLER RESULT PROSE STYLING - "Enchanted Scroll" Theme

   A refined, readable markdown style that uses the app's full color palette.
   Headers use warm foreground tones, accents are used sparingly for emphasis,
   and the overall feel is elegant and easy to read.
   ============================================================================ */

.prose-roll {
  @apply leading-relaxed;
  font-size: 0.9375rem; /* 15px - slightly larger for readability */
  line-height: 1.7;
  color: hsl(25, 25%, 25%); /* Warm charcoal - matches app foreground */
}

/* === HEADERS - Warm tones with accent flourishes === */

.prose-roll h1 {
  @apply text-2xl font-bold mt-5 mb-3 pb-1 first:mt-0;
  font-weight: 700;
  letter-spacing: -0.01em;
  color: hsl(25, 30%, 22%); /* Deep warm brown */
  position: relative;
}

/* Gradient underline using lavender-to-rose accent */
.prose-roll h1::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg,
    hsl(262, 40%, 55%) 0%,
    hsl(300, 35%, 60%) 50%,
    hsl(340, 50%, 65%) 100%
  );
  border-radius: 1px;
}

.prose-roll h2 {
  @apply text-xl font-bold mt-5 mb-2 first:mt-0;
  font-weight: 600;
  letter-spacing: -0.005em;
  color: hsl(25, 28%, 28%); /* Warm brown */
  position: relative;
  padding-left: 0.75em;
}

/* Vertical accent bar - cyan accent */
.prose-roll h2::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0.15em;
  bottom: 0.15em;
  width: 3px;
  background: linear-gradient(180deg,
    hsl(190, 75%, 40%) 0%,
    hsl(190, 60%, 55%) 100%
  );
  border-radius: 2px;
}

.prose-roll h3 {
  @apply text-lg font-semibold mt-4 mb-2 first:mt-0;
  color: hsl(25, 22%, 32%);
  font-weight: 600;
}

.prose-roll h4 {
  @apply text-base font-semibold mt-3 mb-1 first:mt-0;
  color: hsl(25, 18%, 38%);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 0.8125rem;
}

.prose-roll h5,
.prose-roll h6 {
  @apply text-sm font-semibold mt-3 mb-1 first:mt-0;
  color: hsl(25, 15%, 45%);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.75rem;
}

/* === PARAGRAPHS & TEXT === */

.prose-roll p {
  @apply my-3 first:mt-0 last:mb-0;
}

.prose-roll strong {
  font-weight: 700;
  color: hsl(25, 35%, 20%); /* Darker warm for emphasis */
}

.prose-roll em {
  font-style: italic;
  color: hsl(262, 30%, 40%); /* Hint of lavender for italics */
}

/* === LISTS - Elegant markers === */

.prose-roll ul,
.prose-roll ol {
  @apply my-3 pl-6;
}

.prose-roll li {
  @apply my-1.5;
  padding-left: 0.25em;
}

.prose-roll ul li::marker {
  color: hsl(145, 45%, 42%); /* Mint for bullets */
}

.prose-roll ol li::marker {
  color: hsl(40, 70%, 42%); /* Amber for numbers */
  font-weight: 600;
}

/* Nested lists */
.prose-roll li > ul,
.prose-roll li > ol {
  @apply mt-1.5;
}

/* === CODE - Subtle lavender tint === */

.prose-roll code {
  @apply px-1.5 py-0.5 rounded text-sm font-mono;
  background: linear-gradient(135deg, hsl(262, 25%, 94%) 0%, hsl(262, 20%, 90%) 100%);
  color: hsl(262, 45%, 40%);
  border: 1px solid hsl(262, 20%, 82%);
  font-size: 0.85em;
}

.prose-roll pre {
  @apply my-4 p-4 rounded-lg overflow-x-auto;
  background: linear-gradient(180deg, hsl(260, 15%, 96%) 0%, hsl(260, 12%, 93%) 100%);
  border: 1px solid hsl(262, 18%, 85%);
  box-shadow: inset 0 1px 3px hsl(262, 15%, 88%);
}

.prose-roll pre code {
  background: transparent;
  border: none;
  padding: 0;
  font-size: 0.8125rem;
}

/* === BLOCKQUOTES - Warm amber accent === */

.prose-roll blockquote {
  @apply my-4 py-3 px-4 rounded-r-lg;
  border-left: 3px solid hsl(40, 80%, 50%); /* Amber */
  background: linear-gradient(90deg,
    hsl(40, 50%, 95%) 0%,
    hsl(40, 35%, 97%) 50%,
    transparent 100%
  );
  color: hsl(25, 25%, 30%);
  font-style: italic;
  position: relative;
}

/* Opening quote mark */
.prose-roll blockquote::before {
  content: '"';
  position: absolute;
  top: -0.1em;
  left: 0.3em;
  font-size: 2.5em;
  font-family: Georgia, serif;
  color: hsl(40, 60%, 70%);
  line-height: 1;
  opacity: 0.6;
}

.prose-roll blockquote p {
  position: relative;
  z-index: 1;
  margin-left: 1em;
}

/* === HORIZONTAL RULES - Gradient divider === */

.prose-roll hr {
  @apply my-6;
  border: none;
  height: 1px;
  background: linear-gradient(90deg,
    transparent 0%,
    hsl(35, 25%, 75%) 20%,
    hsl(35, 30%, 65%) 50%,
    hsl(35, 25%, 75%) 80%,
    transparent 100%
  );
  position: relative;
}

.prose-roll hr::after {
  content: '◇';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: hsl(40, 40%, 98%);
  padding: 0 0.5em;
  color: hsl(35, 25%, 60%);
  font-size: 0.65rem;
}

/* === LINKS - Primary mint color === */

.prose-roll a {
  color: hsl(145, 50%, 35%); /* Mint - app primary */
  text-decoration: none;
  border-bottom: 1px dotted hsl(145, 40%, 55%);
  transition: all 0.2s ease;
}

.prose-roll a:hover {
  color: hsl(145, 55%, 28%);
  border-bottom-style: solid;
  border-bottom-color: hsl(145, 50%, 40%);
}

/* === TABLES - Clean with warm accents === */

.prose-roll table {
  @apply w-full text-sm my-4;
  border-collapse: separate;
  border-spacing: 0;
  border: 1px solid hsl(35, 25%, 82%);
  border-radius: 0.5rem;
  overflow: hidden;
}

.prose-roll thead {
  background: linear-gradient(180deg, hsl(35, 30%, 93%) 0%, hsl(35, 25%, 89%) 100%);
}

.prose-roll th {
  @apply px-4 py-2.5 text-left font-semibold;
  color: hsl(25, 30%, 25%);
  border-bottom: 2px solid hsl(35, 30%, 75%);
  font-size: 0.8125rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.prose-roll td {
  @apply px-4 py-2.5;
  border-bottom: 1px solid hsl(35, 20%, 90%);
  color: hsl(25, 20%, 30%);
}

.prose-roll tbody tr:last-child td {
  border-bottom: none;
}

.prose-roll tbody tr:hover {
  background: hsl(40, 30%, 96%);
}

/* Alternating row colors for large tables */
.prose-roll tbody tr:nth-child(even) {
  background: hsl(40, 20%, 98%);
}

.prose-roll tbody tr:nth-child(even):hover {
  background: hsl(40, 30%, 95%);
}

/* === IMAGES === */

.prose-roll img {
  @apply my-4 rounded-lg;
  box-shadow: 0 2px 8px hsl(25, 15%, 75%);
  border: 1px solid hsl(35, 20%, 85%);
}

/* ============================================================================
   DARK MODE - Refined with accent glows
   ============================================================================ */

:is(.dark .prose-roll) {
  color: hsl(0, 0%, 88%);
}

/* Dark mode headers */
:is(.dark .prose-roll) h1 {
  color: hsl(0, 0%, 95%);
}

:is(.dark .prose-roll) h1::after {
  background: linear-gradient(90deg,
    hsl(262, 47%, 62%) 0%,
    hsl(300, 40%, 55%) 50%,
    hsl(340, 55%, 62%) 100%
  );
  box-shadow: 0 0 10px hsl(262, 50%, 50% / 0.3);
}

:is(.dark .prose-roll) h2 {
  color: hsl(0, 0%, 92%);
}

:is(.dark .prose-roll) h2::before {
  background: linear-gradient(180deg,
    hsl(187, 85%, 53%) 0%,
    hsl(187, 70%, 42%) 100%
  );
  box-shadow: 0 0 8px hsl(187, 80%, 50% / 0.4);
}

:is(.dark .prose-roll) h3 {
  color: hsl(0, 0%, 88%);
}

:is(.dark .prose-roll) h4 {
  color: hsl(0, 0%, 75%);
}

:is(.dark .prose-roll) h5,
:is(.dark .prose-roll) h6 {
  color: hsl(0, 0%, 65%);
}

/* Dark mode text */
:is(.dark .prose-roll) strong {
  color: hsl(45, 90%, 70%); /* Amber highlight */
}

:is(.dark .prose-roll) em {
  color: hsl(262, 50%, 75%); /* Lavender */
}

/* Dark mode list markers */
:is(.dark .prose-roll) ul li::marker {
  color: hsl(142, 52%, 54%); /* Mint */
}

:is(.dark .prose-roll) ol li::marker {
  color: hsl(45, 93%, 58%); /* Amber */
}

/* Dark mode code - lavender tint */
:is(.dark .prose-roll) code {
  background: linear-gradient(135deg, hsl(262, 25%, 18%) 0%, hsl(262, 20%, 14%) 100%);
  color: hsl(262, 60%, 75%);
  border-color: hsl(262, 30%, 28%);
  box-shadow: 0 0 8px hsl(262, 40%, 30% / 0.3);
}

:is(.dark .prose-roll) pre {
  background: linear-gradient(180deg, hsl(260, 10%, 13%) 0%, hsl(260, 8%, 10%) 100%);
  border-color: hsl(262, 20%, 25%);
  box-shadow: inset 0 1px 3px hsl(0, 0%, 5%);
}

/* Dark mode blockquote - amber accent */
:is(.dark .prose-roll) blockquote {
  border-left-color: hsl(45, 93%, 58%);
  background: linear-gradient(90deg,
    hsl(45, 40%, 12%) 0%,
    hsl(45, 25%, 10%) 50%,
    transparent 100%
  );
  color: hsl(0, 0%, 82%);
  box-shadow: 0 0 15px hsl(45, 60%, 40% / 0.1);
}

:is(.dark .prose-roll) blockquote::before {
  color: hsl(45, 50%, 35%);
}

/* Dark mode horizontal rule */
:is(.dark .prose-roll) hr {
  background: linear-gradient(90deg,
    transparent 0%,
    hsl(0, 0%, 30%) 20%,
    hsl(0, 0%, 40%) 50%,
    hsl(0, 0%, 30%) 80%,
    transparent 100%
  );
}

:is(.dark .prose-roll) hr::after {
  background: hsl(0, 0%, 11%);
  color: hsl(0, 0%, 50%);
}

/* Dark mode links - mint */
:is(.dark .prose-roll) a {
  color: hsl(142, 52%, 54%);
  border-bottom-color: hsl(142, 40%, 35%);
}

:is(.dark .prose-roll) a:hover {
  color: hsl(142, 55%, 65%);
  border-bottom-color: hsl(142, 50%, 50%);
  text-shadow: 0 0 8px hsl(142, 50%, 40% / 0.4);
}

/* Dark mode tables */
:is(.dark .prose-roll) table {
  border-color: hsl(0, 0%, 22%);
}

:is(.dark .prose-roll) thead {
  background: linear-gradient(180deg, hsl(0, 0%, 16%) 0%, hsl(0, 0%, 13%) 100%);
}

:is(.dark .prose-roll) th {
  color: hsl(0, 0%, 90%);
  border-bottom-color: hsl(0, 0%, 28%);
}

:is(.dark .prose-roll) td {
  border-bottom-color: hsl(0, 0%, 18%);
  color: hsl(0, 0%, 82%);
}

:is(.dark .prose-roll) tbody tr:hover {
  background: hsl(0, 0%, 14%);
}

:is(.dark .prose-roll) tbody tr:nth-child(even) {
  background: hsl(0, 0%, 9%);
}

:is(.dark .prose-roll) tbody tr:nth-child(even):hover {
  background: hsl(0, 0%, 13%);
}

/* Dark mode images */
:is(.dark .prose-roll) img {
  box-shadow: 0 2px 12px hsl(0, 0%, 0% / 0.5);
  border-color: hsl(0, 0%, 25%);
}

/* Description Drawer Prose Styling - Grimoire/Parchment Theme */
.prose-description {
  @apply leading-relaxed;
  /* Light mode: amber/parchment colors */
  color: #78350f; /* amber-900 */
}

.prose-description h1 {
  @apply text-xl font-bold mt-4 mb-2 pb-1 border-b first:mt-0;
  border-color: #fde68a; /* amber-200 */
  color: #78350f; /* amber-900 */
}

.prose-description h2 {
  @apply text-lg font-bold mt-3 mb-2 first:mt-0;
  color: #78350f; /* amber-900 */
}

.prose-description h3 {
  @apply text-base font-semibold mt-3 mb-1 first:mt-0;
  color: #92400e; /* amber-800 */
}

.prose-description h4 {
  @apply text-sm font-semibold mt-2 mb-1 uppercase tracking-wide first:mt-0;
  color: #92400e; /* amber-800 */
}

.prose-description h5,
.prose-description h6 {
  @apply text-xs font-semibold mt-2 mb-1 uppercase tracking-wider first:mt-0;
  color: #b45309; /* amber-700 */
}

.prose-description p {
  @apply my-2 first:mt-0 last:mb-0;
}

.prose-description ul,
.prose-description ol {
  @apply my-2 pl-5;
}

.prose-description li {
  @apply my-1;
}

.prose-description ul li::marker {
  color: rgba(245, 158, 11, 0.5); /* amber-500/50 */
}

.prose-description strong {
  @apply font-semibold;
  color: #92400e; /* amber-800 */
}

.prose-description em {
  @apply italic;
  color: #92400e; /* amber-800 */
}

.prose-description code {
  @apply px-1 py-0.5 rounded text-sm font-mono;
  background-color: #fef3c7; /* amber-100 */
  color: #b45309; /* amber-700 */
}

.prose-description blockquote {
  @apply border-l-2 pl-4 my-2 py-1 not-italic;
  border-color: rgba(245, 158, 11, 0.4); /* amber-500/40 */
  background-color: rgba(254, 243, 199, 0.5); /* amber-100/50 */
  color: #b45309; /* amber-700 */
}

.prose-description hr {
  @apply my-4;
  border-color: #fde68a; /* amber-200 */
}

.prose-description a {
  @apply no-underline hover:underline;
  color: #d97706; /* amber-600 */
}

.prose-description table {
  @apply w-full border-collapse text-sm my-3;
}

.prose-description thead {
  @apply border-b;
  border-color: #fde68a; /* amber-200 */
  background-color: rgba(254, 243, 199, 0.5); /* amber-100/50 */
}

.prose-description th {
  @apply px-3 py-2 text-left font-semibold;
  color: #78350f; /* amber-900 */
}

.prose-description td {
  @apply px-3 py-2 border-b;
  border-color: rgba(253, 230, 138, 0.5); /* amber-200/50 */
}

.prose-description tbody tr:hover {
  background-color: #fffbeb; /* amber-50 */
}

/* Dark mode overrides for description prose */
:is(.dark .prose-description) {
  color: #d6d3d1; /* stone-300 */
}

:is(.dark .prose-description) h1 {
  color: #fef3c7; /* amber-100 */
  border-color: #92400e; /* amber-800 */
}

:is(.dark .prose-description) h2 {
  color: #fef3c7; /* amber-100 */
}

:is(.dark .prose-description) h3 {
  color: #fde68a; /* amber-200 */
}

:is(.dark .prose-description) h4,
:is(.dark .prose-description) h5,
:is(.dark .prose-description) h6 {
  color: #fcd34d; /* amber-300 */
}

:is(.dark .prose-description) strong {
  color: #fde68a; /* amber-200 */
}

:is(.dark .prose-description) em {
  color: #e7e5e4; /* stone-200 */
}

:is(.dark .prose-description) code {
  background-color: rgba(41, 37, 36, 0.5); /* stone-800/50 */
  color: #fcd34d; /* amber-300 */
}

:is(.dark .prose-description) blockquote {
  background-color: rgba(41, 37, 36, 0.3); /* stone-800/30 */
  color: #a8a29e; /* stone-400 */
}

:is(.dark .prose-description) a {
  color: #fbbf24; /* amber-400 */
}

:is(.dark .prose-description) thead {
  border-color: #44403c; /* stone-700 */
  background-color: rgba(41, 37, 36, 0.5); /* stone-800/50 */
}

:is(.dark .prose-description) th {
  color: #e7e5e4; /* stone-200 */
}

:is(.dark .prose-description) td {
  border-color: rgba(68, 64, 60, 0.5); /* stone-700/50 */
}

:is(.dark .prose-description) tbody tr:hover {
  background-color: rgba(41, 37, 36, 0.3); /* stone-800/30 */
}

:is(.dark .prose-description) hr {
  border-color: #44403c; /* stone-700 */
}

/* Guide/Documentation Prose Styling */
.prose-guide {
  @apply text-foreground leading-relaxed;
}

.prose-guide h1 {
  @apply text-3xl font-bold mt-8 mb-4 pb-2 border-b border-border;
}

.prose-guide h2 {
  @apply text-2xl font-bold mt-8 mb-4;
}

.prose-guide h3 {
  @apply text-xl font-semibold mt-6 mb-3;
}

.prose-guide h4 {
  @apply text-lg font-semibold mt-4 mb-2;
}

.prose-guide p {
  @apply my-4;
}

.prose-guide > *:first-child {
  @apply mt-0;
}

/* Code syntax highlighting theme */
.prose-guide pre code.hljs {
  @apply bg-transparent p-0;
}

.prose-guide .hljs {
  color: #d4d4d4;
}

.prose-guide .hljs-keyword,
.prose-guide .hljs-selector-tag {
  color: #569cd6;
}

.prose-guide .hljs-string,
.prose-guide .hljs-attr {
  color: #ce9178;
}

.prose-guide .hljs-number {
  color: #b5cea8;
}

.prose-guide .hljs-built_in {
  color: #4ec9b0;
}

.prose-guide .hljs-comment {
  color: #6a9955;
  font-style: italic;
}

.prose-guide .hljs-property {
  color: #9cdcfe;
}

.prose-guide .hljs-punctuation {
  color: #808080;
}

/* Print styles for guide pages */
@media print {
  .prose-guide {
    @apply text-black;
  }

  .prose-guide pre {
    @apply border border-gray-300 bg-gray-50;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .prose-guide a {
    @apply text-black underline;
  }

  .prose-guide a::after {
    content: " (" attr(href) ")";
    @apply text-gray-500 text-sm;
  }
}

/* ============================================================================
   Pattern Preview - Inline Result Highlighting
   ============================================================================ */

/* Base style for inline expression highlights */
.inline-result-expression {
  @apply px-1 py-0.5 rounded cursor-help transition-colors;
}

.inline-result-expression:hover {
  @apply ring-1 ring-offset-1;
  ring-color: currentColor;
}

/* Editable pattern - textarea overlay technique */
.editable-pattern-textarea {
  caret-color: hsl(var(--foreground));
  color: transparent;
  -webkit-text-fill-color: transparent;
}

.editable-pattern-textarea::selection {
  background: hsl(var(--primary) / 0.3);
  color: transparent;
  -webkit-text-fill-color: transparent;
}

/* Firefox-specific selection fix */
.editable-pattern-textarea::-moz-selection {
  background: hsl(var(--primary) / 0.3);
  color: transparent;
}

.editable-pattern-highlight {
  pointer-events: none;
}

/* ============================================================================
   MOBILE EDITOR INTERFACE
   A refined, touch-first editing experience for screens ≤768px
   ============================================================================ */

/* Mobile navigation overlay */
@keyframes mobile-nav-slide-in {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes mobile-nav-slide-out {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100%);
  }
}

@keyframes mobile-backdrop-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes mobile-backdrop-fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

.mobile-nav-enter {
  animation: mobile-nav-slide-in 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.mobile-nav-exit {
  animation: mobile-nav-slide-out 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.mobile-backdrop-enter {
  animation: mobile-backdrop-fade-in 0.2s ease-out forwards;
}

.mobile-backdrop-exit {
  animation: mobile-backdrop-fade-out 0.2s ease-in forwards;
}

/* Focus mode field animation */
@keyframes focus-expand {
  from {
    opacity: 0;
    transform: scale(0.98) translateY(4px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.mobile-focus-expand {
  animation: focus-expand 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

/* Mobile-specific styles - only active on small screens */
@media (max-width: 767px) {
  /* Scroll padding for keyboard awareness */
  html {
    scroll-padding-top: 5rem;
    scroll-padding-bottom: 50vh;
  }

  /* Ensure inputs scroll into view when focused */
  input:focus,
  textarea:focus,
  select:focus {
    scroll-margin-top: 5rem;
    scroll-margin-bottom: 50vh;
  }

  /* Touch-friendly minimum heights */
  .mobile-touch-target {
    min-height: 44px;
  }

  /* Mobile form field styling */
  .mobile-field-group {
    @apply space-y-4;
  }

  .mobile-field-label {
    @apply text-base font-medium mb-2 block;
  }

  .mobile-field-input {
    @apply p-3 text-base rounded-xl;
    min-height: 48px;
  }

  /* Mobile card styling */
  .mobile-card {
    @apply p-4 rounded-xl border bg-card;
  }

  .mobile-card-header {
    @apply p-4 flex items-center gap-3;
    min-height: 56px;
  }

  /* Mobile section headers */
  .mobile-section-header {
    @apply sticky top-0 z-10 py-3 px-4 bg-background/95 backdrop-blur-sm border-b;
    @apply text-sm font-semibold uppercase tracking-wide text-muted-foreground;
  }

  /* Mobile list items */
  .mobile-list-item {
    @apply flex items-center gap-3 p-4 rounded-xl transition-colors;
    min-height: 56px;
  }

  .mobile-list-item:active {
    @apply bg-accent/70;
  }

  /* Mobile action buttons */
  .mobile-action-btn {
    @apply flex items-center justify-center rounded-xl transition-all;
    @apply text-muted-foreground hover:text-foreground;
    min-width: 44px;
    min-height: 44px;
  }

  .mobile-action-btn:active {
    @apply scale-95 bg-accent;
  }

  /* Mobile FAB (Floating Action Button) */
  .mobile-fab {
    @apply fixed z-50 flex items-center justify-center;
    @apply bg-primary text-primary-foreground;
    @apply rounded-2xl shadow-lg;
    width: 56px;
    height: 56px;
    bottom: calc(env(safe-area-inset-bottom, 0px) + 1.5rem);
    right: 1.5rem;
    transition: transform 0.2s cubic-bezier(0.16, 1, 0.3, 1),
                box-shadow 0.2s ease,
                background-color 0.15s ease;
  }

  .mobile-fab:active {
    transform: scale(0.92);
    box-shadow: 0 4px 12px -2px hsl(var(--primary) / 0.3);
  }

  .mobile-fab-extended {
    width: auto;
    padding: 0 1.25rem;
    gap: 0.5rem;
    font-weight: 600;
  }

  /* Mobile full-screen overlay */
  .mobile-overlay {
    @apply fixed inset-0 z-50;
  }

  .mobile-overlay-backdrop {
    @apply absolute inset-0 bg-black/60 backdrop-blur-sm;
  }

  .mobile-overlay-content {
    @apply absolute top-0 right-0 bottom-0 w-full max-w-sm;
    @apply bg-background border-l border-border/50;
    @apply flex flex-col overflow-hidden;
    box-shadow: -8px 0 32px -8px rgba(0, 0, 0, 0.15);
  }

  .mobile-overlay-header {
    @apply flex items-center justify-between p-4 border-b;
    min-height: 60px;
  }

  .mobile-overlay-body {
    @apply flex-1 overflow-y-auto overscroll-contain;
    -webkit-overflow-scrolling: touch;
  }

  /* Mobile focus mode overlay */
  .mobile-focus-overlay {
    @apply fixed inset-0 z-40 flex flex-col;
    @apply bg-background;
  }

  .mobile-focus-header {
    @apply flex items-center justify-between p-4 border-b;
    @apply bg-card/80 backdrop-blur-sm;
    min-height: 60px;
  }

  .mobile-focus-content {
    @apply flex-1 p-4 overflow-y-auto;
  }

  .mobile-focus-footer {
    @apply p-4 border-t bg-card/80 backdrop-blur-sm;
    padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 1rem);
  }

  /* Mobile tabs - horizontal scroll */
  .mobile-tabs {
    @apply flex overflow-x-auto gap-1 p-2;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .mobile-tabs::-webkit-scrollbar {
    display: none;
  }

  .mobile-tab {
    @apply flex-shrink-0 px-4 py-2.5 rounded-xl font-medium text-sm;
    @apply text-muted-foreground transition-colors;
    scroll-snap-align: center;
    min-height: 44px;
  }

  .mobile-tab-active {
    @apply bg-primary/10 text-primary;
  }

  /* Dim siblings when a field is focused */
  .mobile-form-container:has(input:focus, textarea:focus, select:focus) > *:not(:focus-within) {
    opacity: 0.4;
    transition: opacity 0.2s ease;
  }

  .mobile-form-container > *:focus-within {
    opacity: 1;
    position: relative;
    z-index: 1;
  }

  /* Mobile entry card */
  .mobile-entry-card {
    @apply border rounded-xl overflow-hidden bg-card;
    @apply transition-shadow;
  }

  .mobile-entry-card:has(input:focus, textarea:focus) {
    @apply ring-2 ring-primary/30;
    box-shadow: 0 0 0 4px hsl(var(--primary) / 0.1);
  }

  .mobile-entry-header {
    @apply p-3 flex items-start gap-3 bg-muted/30;
  }

  .mobile-entry-content {
    @apply p-3 space-y-3;
  }

  .mobile-entry-actions {
    @apply flex items-center justify-end gap-2 p-3 pt-0;
  }

  /* Mobile drag handle */
  .mobile-drag-handle {
    @apply flex items-center justify-center w-10 h-10 -ml-1;
    @apply text-muted-foreground/50 touch-none;
  }

  /* Hide desktop-only elements */
  .desktop-only {
    display: none !important;
  }
}

/* Show mobile-only elements only on mobile */
@media (min-width: 768px) {
  .mobile-only {
    display: none !important;
  }
}
